define ("tool_time_report/generate_report",["jquery","core/ajax","core/notification"],function(a,b,c){"use strict";var d=function(d,f,g,h){this.requestorId=parseInt(d);this.userId=parseInt(f);this.userName=g;this.start=null;this.end=null;this.contextId=h;this.timer=2500;this.file=!1;this.formdata={};this.polling=null;a("#submitdate").click(function(d){d.preventDefault();var f=a("#startInput").val(),g=a("#endInput").val(),h=this.checkCompletion(f,g);if(!h){return c.alert("Erreur","Saisir les dates de d\xE9but et de fin de p\xE9riode.")}var i={requestorid:this.requestorId,userid:this.userId,username:this.userName,start:a("#startInput").val(),end:a("#endInput").val(),contextid:this.contextId};this.formdata=i;b.call([{methodname:"tool_time_report_generate_time_report",args:{jsonformdata:JSON.stringify(i)},done:function(){a("#report-area").addClass("alert-warning").html("<div class=\"spinner-border text-warning\" role=\"status\"></div> Chargement du rapport...");var b=this;(function(){b.polling=setInterval(e.bind(b),7500)})()}.bind(this),fail:c.exception}])}.bind(this))};d.prototype.checkCompletion=function(a,b){if(0==a.length||0==b.length){return!1}return!0};var e=function(){b.call([{methodname:"tool_time_report_poll_report_file",args:{jsonformdata:JSON.stringify(this.formdata)},done:function(b){if(!0==b.status){a("#report-area").removeClass("alert-warning").addClass("alert-success").html("<a href=\""+b.path+"\" target=\"_blank\"><i class=\"fa fa-download\"></i> T\xE9l\xE9charger le rapport</a>");clearInterval(this.polling)}}.bind(this),fail:c.exception}])};return{generateReport:function generateReport(a,b,c,e){return new d(a,b,c,e)}}});
//# sourceMappingURL=generate_report.min.js.map
