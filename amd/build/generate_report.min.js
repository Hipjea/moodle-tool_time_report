define ("tool_time_report/generate_report",["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){"use strict";var e=function(e,g,h,i){this.requestorId=parseInt(e);this.userId=parseInt(g);this.userName=h;this.start=null;this.end=null;this.contextId=i;this.timer=2500;this.file=!1;this.formdata={};this.polling=null;a("#submitdate").click(function(g){g.preventDefault();var e=a("#startInput").val(),h=a("#endInput").val(),i=this.checkCompletion(e,h);if(!i){return d.alert(c.get_string("error"),c.get_string("error:completiondates","tool_time_report"))}var j={requestorid:this.requestorId,userid:this.userId,username:this.userName,start:a("#startInput").val(),end:a("#endInput").val(),contextid:this.contextId};this.formdata=j;b.call([{methodname:"tool_time_report_generate_time_report",args:{jsonformdata:JSON.stringify(j)},done:function(){c.get_string("client:reportgenerating","tool_time_report").done(function(b){a("#report-area").addClass("alert-warning").html("<div class=\"spinner-border text-warning\" role=\"status\"></div> "+b)});var b=this;(function(){b.polling=setInterval(f.bind(b),7500)})()}.bind(this),fail:d.exception}])}.bind(this))};e.prototype.checkCompletion=function(a,b){if(0==a.length||0==b.length){return!1}return!0};var f=function(){b.call([{methodname:"tool_time_report_poll_report_file",args:{jsonformdata:JSON.stringify(this.formdata)},done:function(b){if(!0==b.status){c.get_string("client:reportdownload","tool_time_report").done(function(c){a("#report-area").removeClass("alert-warning").addClass("alert-success").html("<a href=\""+b.path+"\" target=\"_blank\"><i class=\"fa fa-download\"></i> "+c+"</a>")});clearInterval(this.polling)}}.bind(this),fail:d.exception}])};return{generateReport:function generateReport(a,b,c,d){return new e(a,b,c,d)}}});
//# sourceMappingURL=generate_report.min.js.map
